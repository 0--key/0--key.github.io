---
layout: post
title: Neural Network
tagline: " written in Python OOP"
permalink: /machine-learning/neural-network/oop-concept.html
categories: [machine learning, neural networks]
tags: [perceptron, oop]
---

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org95863ce">Definition</a>
<ul>
<li><a href="#orgbbcb75c">What is a neural network?</a></li>
<li><a href="#org713d5cb">What is brain?</a></li>
<li><a href="#orgdca3876">What is a neuron?</a></li>
</ul>
</li>
<li><a href="#org7cb1feb">Implementation</a>
<ul>
<li><a href="#org8f37728">Inlet</a></li>
<li><a href="#org0eb3afd">Dendron</a></li>
<li><a href="#orgb00da69">Soma</a></li>
<li><a href="#org94364bf">Neural Network</a></li>
<li><a href="#orgc82fd28">Test suite</a></li>
</ul>
</li>
</ul>
</div>
</div>

<div id="outline-container-org95863ce" class="outline-2">
<h2 id="org95863ce">Definition</h2>
<div class="outline-text-2" id="text-org95863ce">
</div><div id="outline-container-orgbbcb75c" class="outline-3">
<h3 id="orgbbcb75c">What is a neural network?</h3>
<div class="outline-text-3" id="text-orgbbcb75c">
<blockquote>
<p>
a computer system modelled on the human <i>brain</i> and nervous system
</p>
</blockquote>
</div>
</div>

<div id="outline-container-org713d5cb" class="outline-3">
<h3 id="org713d5cb">What is brain?</h3>
<div class="outline-text-3" id="text-org713d5cb">
<p>
With no doubt it is a giant nebula (10<sup>14</sup>) of nervous cells
interconnected by 1.7 * 10<sup>8</sup> meters of bound tissue.
</p>

<div class="figure">
<p><img src="http://0--key.github.io/assets/img/neural_networks/white_matter.jpg" alt="How it looks like" title="A raw sketch" />
</p>
<p><span class="figure-number">Figure 1: </span>Interconnections</p>
</div>
</div>
</div>

<div id="outline-container-orgdca3876" class="outline-3">
<h3 id="orgdca3876">What is a neuron?</h3>
<div class="outline-text-3" id="text-orgdca3876">

<div class="figure">
<p><img src="http://0--key.github.io/assets/img/neural_networks/neuron_anatomy.jpg" alt="How it looks like" title="A raw sketch" />
</p>
<p><span class="figure-number">Figure 2: </span>Neuron anatomy</p>
</div>

<p>
Nerve Cell: Dendrites receive messages from other neurons. The
message then moves through the axon to the other end of the neuron,
then to the tips of the axon and then into the space between
neurons. From there the message can move to the next neuron.
</p>
</div>
</div>
</div>


<div id="outline-container-org7cb1feb" class="outline-2">
<h2 id="org7cb1feb">Implementation</h2>
<div class="outline-text-2" id="text-org7cb1feb">
</div><div id="outline-container-org8f37728" class="outline-3">
<h3 id="org8f37728">Inlet</h3>
<div class="outline-text-3" id="text-org8f37728">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #87cefa;">class</span> <span style="color: #98fb98; font-size: 90%; font-weight: bold;">Inlet</span>(<span style="color: #4682b4;">object</span>):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #deb887; font-style: italic;">"""Input signal into dendron"""</span>
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">def</span> <span style="color: #87cefa; font-size: 90%; font-weight: bold;">__init__</span>(<span style="color: #87cefa;">self</span>):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">pass</span>
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">def</span> <span style="color: #87cefa; font-size: 90%; font-weight: bold;">modulate</span>(<span style="color: #87cefa;">self</span>, signal):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.signal = signal
</pre>
</div>
</div>
</div>

<div id="outline-container-org0eb3afd" class="outline-3">
<h3 id="org0eb3afd">Dendron</h3>
<div class="outline-text-3" id="text-org0eb3afd">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #87cefa;">class</span> <span style="color: #98fb98; font-size: 90%; font-weight: bold;">Dendron</span>(<span style="color: #4682b4;">object</span>):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #deb887; font-style: italic;">"""Convey signal to neuron"""</span>
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">def</span> <span style="color: #87cefa; font-size: 90%; font-weight: bold;">__init__</span>(<span style="color: #87cefa;">self</span>, neuron, inlet, weight=0.1):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.neuron = neuron
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.weight = weight
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.inlet = inlet
</pre>
</div>
</div>
</div>

<div id="outline-container-orgb00da69" class="outline-3">
<h3 id="orgb00da69">Soma</h3>
<div class="outline-text-3" id="text-orgb00da69">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #87cefa;">class</span> <span style="color: #98fb98; font-size: 90%; font-weight: bold;">Neuron</span>(<span style="color: #4682b4;">object</span>):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #deb887; font-style: italic;">"""Processing module itself"""</span>
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">def</span> <span style="color: #87cefa; font-size: 90%; font-weight: bold;">__init__</span>(<span style="color: #87cefa;">self</span>, df=<span style="color: #87cefa;">lambda</span> x: x):  <span style="color: #cdc0b0; font-style: italic;"># </span><span style="color: #cdc0b0; font-style: italic;">sigmoidal</span>
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.df = df
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.dendrons = []
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.output = 0
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">def</span> <span style="color: #87cefa; font-size: 90%; font-weight: bold;">calculate_output</span>(<span style="color: #87cefa;">self</span>):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">for</span> dendron <span style="color: #87cefa;">in</span> <span style="color: #87cefa;">self</span>.dendrons:
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.output += <span style="color: #87cefa;">self</span>.df(
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   dendron.weight *
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   dendron.inlet.signal)
</pre>
</div>
</div>
</div>

<div id="outline-container-org94364bf" class="outline-3">
<h3 id="org94364bf">Neural Network</h3>
<div class="outline-text-3" id="text-org94364bf">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #87cefa;">class</span> <span style="color: #98fb98; font-size: 90%; font-weight: bold;">NeuralNetwork</span>(<span style="color: #4682b4;">object</span>):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #deb887; font-style: italic;">"""Ties all classes above together"""</span>
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">def</span> <span style="color: #87cefa; font-size: 90%; font-weight: bold;">__init__</span>(<span style="color: #87cefa;">self</span>, swing):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #deb887; font-style: italic;">"""Creates network with swing number of inlets and equal number of</span>
<span style="color: #f5deb3; background-color: #0a0a0a; font-style: italic;"> </span><span style="color: #deb887; font-style: italic;">   </span><span style="color: #f5deb3; background-color: #0a0a0a; font-style: italic;"> </span><span style="color: #deb887; font-style: italic;">   neurons interconnected by dendrons</span>

<span style="color: #f5deb3; background-color: #0a0a0a; font-style: italic;"> </span><span style="color: #deb887; font-style: italic;">   </span><span style="color: #f5deb3; background-color: #0a0a0a; font-style: italic;"> </span><span style="color: #deb887; font-style: italic;">   """</span>
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.network_swing = swing
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.inlets = []
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.neurons = []
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.dendrons = []
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">for</span> i <span style="color: #87cefa;">in</span> <span style="color: #4682b4;">range</span>(swing):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.inlets.append(Inlet())
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.neurons.append(Neuron())
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">for</span> j <span style="color: #87cefa;">in</span> <span style="color: #4682b4;">range</span>(swing):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.dendrons.append(
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   Dendron(<span style="color: #87cefa;">self</span>.neurons[-1],
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.inlets[-1]))
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.neurons[-1].dendrons.append(<span style="color: #87cefa;">self</span>.dendrons[-1])
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">def</span> <span style="color: #87cefa; font-size: 90%; font-weight: bold;">eval_input</span>(<span style="color: #87cefa;">self</span>, input_array):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">for</span> i <span style="color: #87cefa;">in</span> <span style="color: #4682b4;">range</span>(<span style="color: #87cefa;">self</span>.network_swing):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.inlets[i].modulate(input_array[i])
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">for</span> i <span style="color: #87cefa;">in</span> <span style="color: #87cefa;">self</span>.neurons:
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   i.calculate_output()
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">def</span> <span style="color: #87cefa; font-size: 90%; font-weight: bold;">update_weights</span>(<span style="color: #87cefa;">self</span>, weights_array):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">for</span> i <span style="color: #87cefa;">in</span> <span style="color: #4682b4;">range</span>(<span style="color: #87cefa;">self</span>.network_swing ** 2):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.dendrons[i]<span style="color: #7fffd4;">.weight</span> = weights_array[i]
</pre>
</div>
</div>
</div>

<div id="outline-container-orgc82fd28" class="outline-3">
<h3 id="orgc82fd28">Test suite</h3>
<div class="outline-text-3" id="text-orgc82fd28">
</div><div id="outline-container-org299d86d" class="outline-4">
<h4 id="org299d86d">Network initialization</h4>
<div class="outline-text-4" id="text-org299d86d">
<div class="org-src-container">
<pre class="src src-python"><span style="color: #7fffd4;">NN</span> = NeuralNetwork(2)
NN.update_weights([0.1, 0.2, 0.3, 0.4])
<span style="color: #87cefa;">for</span> i <span style="color: #87cefa;">in</span> NN.dendrons:
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">print</span>(i.weight)
</pre>
</div>

<pre class="example">

&gt;&gt;&gt; ... ... 0.1
0.2
0.3
0.4

</pre>
</div>
</div>

<div id="outline-container-org5ca607f" class="outline-4">
<h4 id="org5ca607f">Input handling</h4>
<div class="outline-text-4" id="text-org5ca607f">
<div class="org-src-container">
<pre class="src src-python">NN.eval_input([1, 1])
<span style="color: #87cefa;">for</span> i <span style="color: #87cefa;">in</span> NN.neurons:
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">print</span>(i.output)    
</pre>
</div>

<pre class="example">

... ... 0.30000000000000004
0.7

</pre>
</div>
</div>
</div>
</div>
