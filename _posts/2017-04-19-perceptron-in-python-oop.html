---
layout: post
title: Perceptron
tagline: " written in Python OOP"
permalink: /machine-learning/neural-network/perceptron/oop-concept.html
categories: [machine learning, neural networks]
tags: [perceptron, oop]
---

<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#org95863ce">Definition</a>
<ul>
<li><a href="#orgb3709a5">What is a perceptron?</a></li>
<li><a href="#org9d8a082">What is neuron?</a></li>
</ul>
</li>
<li><a href="#org7cb1feb">Implementation</a></li>
</ul>
</div>
</div>

<div id="outline-container-org95863ce" class="outline-2">
<h2 id="org95863ce">Definition</h2>
<div class="outline-text-2" id="text-org95863ce">
</div><div id="outline-container-orgb3709a5" class="outline-3">
<h3 id="orgb3709a5">What is a perceptron?</h3>
<div class="outline-text-3" id="text-orgb3709a5">
<blockquote>
<p>
a computer model or computerized machine devised to represent or
simulate the ability of the brain to recognize and discriminate.
</p>
</blockquote>

<p>
In an initial form the perceptron is a single-layer neural
network, which has no any hidden units among input and output.
</p>
</div>
</div>

<div id="outline-container-org9d8a082" class="outline-3">
<h3 id="org9d8a082">What is neuron?</h3>
<div class="outline-text-3" id="text-org9d8a082">

<div class="figure">
<p><img src="http://0--key.github.io/assets/img/neural_networks/neuron_anatomy.jpg" alt="How it looks like" width="40%" title="A raw sketch" align="right" />
</p>
<p><span class="figure-number">Figure 1: </span>Neuron anatomy</p>
</div>

<p>
Nerve Cell: Dendrites receive messages from other neurons. The
message then moves through the axon to the other end of the neuron,
then to the tips of the axon and then into the space between
neurons. From there the message can move to the next neuron.
</p>
</div>
</div>
</div>


<div id="outline-container-org7cb1feb" class="outline-2">
<h2 id="org7cb1feb">Implementation</h2>
<div class="outline-text-2" id="text-org7cb1feb">
<div class="org-src-container">
<pre class="src src-python" id="orgd5b982a"><span style="color: #cdc0b0; font-style: italic;">#</span><span style="color: #cdc0b0; font-style: italic;">!/usr/bin/env python</span>
<span style="color: #cdc0b0; font-style: italic;"># </span><span style="color: #cdc0b0; font-style: italic;">-*- coding: utf-8 -*-</span>
<span style="color: #deb887; font-style: italic;">"""</span>
<span style="color: #deb887; font-style: italic;">Single layer neural network</span>
<span style="color: #deb887; font-style: italic;">"""</span>

<span style="color: #cdc0b0; font-style: italic;"># </span><span style="color: #cdc0b0; font-style: italic;">def sigmoidal_function(signal,</span>


<span style="color: #87cefa;">class</span> <span style="color: #98fb98; font-size: 90%; font-weight: bold;">Inlet</span>(<span style="color: #4682b4;">object</span>):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #deb887; font-style: italic;">"""Input signal into dendron"""</span>

<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">def</span> <span style="color: #87cefa; font-size: 90%; font-weight: bold;">__init__</span>(<span style="color: #87cefa;">self</span>):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">pass</span>

<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">def</span> <span style="color: #87cefa; font-size: 90%; font-weight: bold;">modulate</span>(<span style="color: #87cefa;">self</span>, signal):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.signal = signal


<span style="color: #87cefa;">class</span> <span style="color: #98fb98; font-size: 90%; font-weight: bold;">Dendron</span>(<span style="color: #4682b4;">object</span>):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #deb887; font-style: italic;">"""Convey signal to neuron"""</span>

<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">def</span> <span style="color: #87cefa; font-size: 90%; font-weight: bold;">__init__</span>(<span style="color: #87cefa;">self</span>, neuron, inlet, weight=0.1):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.neuron = neuron
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.weight = weight
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.inlet = inlet


<span style="color: #87cefa;">class</span> <span style="color: #98fb98; font-size: 90%; font-weight: bold;">Neuron</span>(<span style="color: #4682b4;">object</span>):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #deb887; font-style: italic;">"""Processing module itself"""</span>

<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">def</span> <span style="color: #87cefa; font-size: 90%; font-weight: bold;">__init__</span>(<span style="color: #87cefa;">self</span>, df=<span style="color: #87cefa;">lambda</span> x: x):  <span style="color: #cdc0b0; font-style: italic;"># </span><span style="color: #cdc0b0; font-style: italic;">sigmoidal</span>
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.df = df
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.dendrons = []
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.output = 0

<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">def</span> <span style="color: #87cefa; font-size: 90%; font-weight: bold;">calculate_output</span>(<span style="color: #87cefa;">self</span>):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">for</span> dendron <span style="color: #87cefa;">in</span> <span style="color: #87cefa;">self</span>.dendrons:
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.output += <span style="color: #87cefa;">self</span>.df(
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   dendron.weight *
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   dendron.inlet.signal)


<span style="color: #87cefa;">class</span> <span style="color: #98fb98; font-size: 90%; font-weight: bold;">NeuralNetwork</span>(<span style="color: #4682b4;">object</span>):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #deb887; font-style: italic;">"""Ties all classes above together"""</span>

<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">def</span> <span style="color: #87cefa; font-size: 90%; font-weight: bold;">__init__</span>(<span style="color: #87cefa;">self</span>, swing):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #deb887; font-style: italic;">"""Creates network with swing number of inlets and equal number of</span>
<span style="color: #f5deb3; background-color: #0a0a0a; font-style: italic;"> </span><span style="color: #deb887; font-style: italic;">   </span><span style="color: #f5deb3; background-color: #0a0a0a; font-style: italic;"> </span><span style="color: #deb887; font-style: italic;">   neurons interconnected by dendrons</span>

<span style="color: #f5deb3; background-color: #0a0a0a; font-style: italic;"> </span><span style="color: #deb887; font-style: italic;">   </span><span style="color: #f5deb3; background-color: #0a0a0a; font-style: italic;"> </span><span style="color: #deb887; font-style: italic;">   """</span>
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.network_swing = swing
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.inlets = []
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.neurons = []
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.dendrons = []
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">for</span> i <span style="color: #87cefa;">in</span> <span style="color: #4682b4;">range</span>(swing):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.inlets.append(Inlet())
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.neurons.append(Neuron())
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">for</span> j <span style="color: #87cefa;">in</span> <span style="color: #4682b4;">range</span>(swing):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.dendrons.append(
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   Dendron(<span style="color: #87cefa;">self</span>.neurons[-1],
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.inlets[-1]))
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.neurons[-1].dendrons.append(<span style="color: #87cefa;">self</span>.dendrons[-1])

<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">def</span> <span style="color: #87cefa; font-size: 90%; font-weight: bold;">eval_input</span>(<span style="color: #87cefa;">self</span>, input_array):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">for</span> i <span style="color: #87cefa;">in</span> <span style="color: #4682b4;">range</span>(<span style="color: #87cefa;">self</span>.network_swing):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.inlets[i].modulate(input_array[i])
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">for</span> i <span style="color: #87cefa;">in</span> <span style="color: #87cefa;">self</span>.neurons:
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   i.calculate_output()


<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">def</span> <span style="color: #87cefa; font-size: 90%; font-weight: bold;">update_weights</span>(<span style="color: #87cefa;">self</span>, weights_array):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">for</span> i <span style="color: #87cefa;">in</span> <span style="color: #4682b4;">range</span>(<span style="color: #87cefa;">self</span>.network_swing ** 2):
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">self</span>.dendrons[i]<span style="color: #7fffd4;">.weight</span> = weights_array[i]

<span style="color: #7fffd4;">NN</span> = NeuralNetwork(2)
NN.update_weights([0.1, 0.2, 0.3, 0.4])
<span style="color: #87cefa;">for</span> i <span style="color: #87cefa;">in</span> NN.dendrons:
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">print</span>(i.weight)
NN.eval_input([1, 1])
<span style="color: #87cefa;">for</span> i <span style="color: #87cefa;">in</span> NN.neurons:
<span style="color: #f5deb3; background-color: #0a0a0a;"> </span>   <span style="color: #87cefa;">print</span>(i.output)
</pre>
</div>

<pre class="example">
0.1
0.2
0.3
0.4
0.30000000000000004
0.7
</pre>
</div>
</div>
